/localdisk/home/kchhatba/mambaforge/envs/snakePipes/bin/ChIP-seq -d . --singleEnd --windowSize 1000 --bwBinSize 1000 --fragmentLength 150 --local --snakemakeOptions -p -j 64 --peakCaller MACS2 --peakCallerOptions -g mm -m 1 30 -p 0.2 --call-summits --keep-dup all --bigWigType log2ratio GRCm38_gencode_release19 ../GSE139509.ChIP.dict.yaml

TMPDIR=/datastore/homes3/kchhatba/temp PYTHONNOUSERSITE=True /localdisk/home/kchhatba/mambaforge/envs/snakePipes/bin/snakemake --use-conda --conda-prefix /localdisk/home/kchhatba/mambaforge/envs -p -j 64 --latency-wait 300 --snakefile /localdisk/home/kchhatba/mambaforge/envs/snakePipes/lib/python3.10/site-packages/snakePipes/workflows/ChIP-seq/Snakefile --jobs 5 --directory /datastore/homes3/kchhatba/abird/abird/Ibrahim_rebuttal_efforts/source_code/chipseq/data/GSE139509_DNA_mapping --configfile /datastore/homes3/kchhatba/abird/abird/Ibrahim_rebuttal_efforts/source_code/chipseq/data/GSE139509_DNA_mapping/ChIP-seq.config.yaml --keep-going


---- This analysis has been done using snakePipes version 2.5.3 ----
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 5
Rules claiming more threads will be scaled down.
Job stats:
job                         count    min threads    max threads
------------------------  -------  -------------  -------------
MACS2                           4              1              1
MACS2_peak_qc                   4              1              1
all                             1              1              1
bamCompare_log2                 4              5              5
convert_flagstat_output         8              1              1
plotFingerprint                 1              5              5
qc_report_all                   1              1              1
report_flagstat_all_data        1              1              1
total                          24              1              5

Select jobs to execute...

[Wed Jul 27 13:50:09 2022]
rule plotFingerprint:
    input: filtered_bam/SRR10356997.filtered.bam, filtered_bam/SRR10356998.filtered.bam, filtered_bam/SRR10356999.filtered.bam, filtered_bam/SRR10357000.filtered.bam, filtered_bam/SRR10357001.filtered.bam, filtered_bam/SRR10357002.filtered.bam, filtered_bam/SRR10357003.filtered.bam, filtered_bam/SRR10357004.filtered.bam, filtered_bam/SRR10356997.filtered.bam.bai, filtered_bam/SRR10356998.filtered.bam.bai, filtered_bam/SRR10356999.filtered.bam.bai, filtered_bam/SRR10357000.filtered.bam.bai, filtered_bam/SRR10357001.filtered.bam.bai, filtered_bam/SRR10357002.filtered.bam.bai, filtered_bam/SRR10357003.filtered.bam.bai, filtered_bam/SRR10357004.filtered.bam.bai
    output: deepTools_ChIP/plotFingerprint/plotFingerprint.metrics.txt
    log: deepTools_ChIP/logs/plotFingerprint.out, deepTools_ChIP/logs/plotFingerprint.err
    jobid: 1
    benchmark: deepTools_ChIP/.benchmark/plotFingerprint.benchmark
    reason: Missing output files: deepTools_ChIP/plotFingerprint/plotFingerprint.metrics.txt
    threads: 5
    resources: tmpdir=/datastore/homes3/kchhatba/temp


    plotFingerprint             -b filtered_bam/SRR10356997.filtered.bam filtered_bam/SRR10356998.filtered.bam filtered_bam/SRR10356999.filtered.bam filtered_bam/SRR10357000.filtered.bam filtered_bam/SRR10357001.filtered.bam filtered_bam/SRR10357002.filtered.bam filtered_bam/SRR10357003.filtered.bam filtered_bam/SRR10357004.filtered.bam              --labels SRR10356997 SRR10356998 SRR10356999 SRR10357000 SRR10357001 SRR10357002 SRR10357003 SRR10357004             --plotTitle 'Cumulative read counts per bin without duplicates'             --ignoreDuplicates             --outQualityMetrics deepTools_ChIP/plotFingerprint/plotFingerprint.metrics.txt             -p 5             --blackListFileName /datastore/homes3/kchhatba/temp/GRCm38_gencode_release19/mm10-blacklist.v2.bed             --plotFile deepTools_ChIP/plotFingerprint/plotFingerprint.png             --extendReads 150             --JSDsample filtered_bam/SRR10356999.filtered.bam > deepTools_ChIP/logs/plotFingerprint.out 2> deepTools_ChIP/logs/plotFingerprint.err
    
Activating conda environment: ../../../../../../../../../../localdisk/home/kchhatba/mambaforge/envs/13f8b7bb80e180b51e4fd84d66270711
[Wed Jul 27 17:36:33 2022]
Finished job 1.
1 of 24 steps (4%) done
Select jobs to execute...

[Wed Jul 27 17:36:33 2022]
rule bamCompare_log2:
    input: filtered_bam/SRR10356997.filtered.bam, filtered_bam/SRR10356997.filtered.bam.bai, filtered_bam/SRR10356999.filtered.bam, filtered_bam/SRR10356999.filtered.bam.bai
    output: deepTools_ChIP/bamCompare/SRR10356997.filtered.log2ratio.over_SRR10356999.bw
    log: deepTools_ChIP/logs/bamCompare.log2ratio.SRR10356997.SRR10356999.filtered.out, deepTools_ChIP/logs/bamCompare.log2ratio.SRR10356997.SRR10356999.filtered.err
    jobid: 2
    benchmark: deepTools_ChIP/.benchmark/bamCompare.log2ratio.SRR10356997.SRR10356999.filtered.benchmark
    reason: Missing output files: deepTools_ChIP/bamCompare/SRR10356997.filtered.log2ratio.over_SRR10356999.bw
    wildcards: chip_sample=SRR10356997, control_name=SRR10356999
    threads: 5
    resources: tmpdir=/datastore/homes3/kchhatba/temp


    bamCompare -b1 filtered_bam/SRR10356997.filtered.bam                -b2 filtered_bam/SRR10356999.filtered.bam                -o deepTools_ChIP/bamCompare/SRR10356997.filtered.log2ratio.over_SRR10356999.bw                --operation log2                 --scaleFactorsMethod readCount                 --ignoreForNormalization chrX chrY chrM GL456210.1 GL456211.1 GL456212.1 GL456213.1 GL456216.1 GL456219.1 GL456221.1 GL456233.1 GL456239.1 GL456350.1 GL456354.1 GL456359.1 GL456360.1 GL456366.1 GL456367.1 GL456368.1 GL456370.1 GL456372.1 GL456378.1 GL456379.1 GL456381.1 GL456382.1 GL456383.1 GL456385.1 GL456387.1 GL456389.1 GL456390.1 GL456392.1 GL456393.1 GL456394.1 GL456396.1 JH584292.1 JH584293.1 JH584294.1 JH584295.1 JH584296.1 JH584297.1 JH584298.1 JH584299.1 JH584300.1 JH584301.1 JH584302.1 JH584303.1 JH584304.1                --binSize 1000                -p 5                --extendReads 150                --blackListFileName /datastore/homes3/kchhatba/temp/GRCm38_gencode_release19/mm10-blacklist.v2.bed > deepTools_ChIP/logs/bamCompare.log2ratio.SRR10356997.SRR10356999.filtered.out 2> deepTools_ChIP/logs/bamCompare.log2ratio.SRR10356997.SRR10356999.filtered.err
    
Activating conda environment: ../../../../../../../../../../localdisk/home/kchhatba/mambaforge/envs/13f8b7bb80e180b51e4fd84d66270711
[Wed Jul 27 17:39:38 2022]
Finished job 2.
2 of 24 steps (8%) done
Select jobs to execute...

[Wed Jul 27 17:39:38 2022]
rule convert_flagstat_output:
    input: Sambamba/SRR10356997.markdup.txt
    output: Sambamba/SRR10356997.dup.converted.tsv
    log: Sambamba/logs/SRR10356997.convert_flagstat_output.log
    jobid: 16
    reason: Missing output files: Sambamba/SRR10356997.dup.converted.tsv
    wildcards: sample=SRR10356997
    resources: tmpdir=/datastore/homes3/kchhatba/temp


        sed -n '1p;4p;5p' Sambamba/SRR10356997.markdup.txt | cut -d' ' -f1 | tr '
' '	' | sed 's/^/SRR10356997	/' | sed -e '$a\' > Sambamba/SRR10356997.dup.converted.tsv 2> Sambamba/logs/SRR10356997.convert_flagstat_output.log
        

[Wed Jul 27 17:39:38 2022]
rule convert_flagstat_output:
    input: Sambamba/SRR10356999.markdup.txt
    output: Sambamba/SRR10356999.dup.converted.tsv
    log: Sambamba/logs/SRR10356999.convert_flagstat_output.log
    jobid: 18
    reason: Missing output files: Sambamba/SRR10356999.dup.converted.tsv
    wildcards: sample=SRR10356999
    resources: tmpdir=/datastore/homes3/kchhatba/temp


        sed -n '1p;4p;5p' Sambamba/SRR10356999.markdup.txt | cut -d' ' -f1 | tr '
' '	' | sed 's/^/SRR10356999	/' | sed -e '$a\' > Sambamba/SRR10356999.dup.converted.tsv 2> Sambamba/logs/SRR10356999.convert_flagstat_output.log
        

[Wed Jul 27 17:39:38 2022]
rule convert_flagstat_output:
    input: Sambamba/SRR10357002.markdup.txt
    output: Sambamba/SRR10357002.dup.converted.tsv
    log: Sambamba/logs/SRR10357002.convert_flagstat_output.log
    jobid: 21
    reason: Missing output files: Sambamba/SRR10357002.dup.converted.tsv
    wildcards: sample=SRR10357002
    resources: tmpdir=/datastore/homes3/kchhatba/temp


        sed -n '1p;4p;5p' Sambamba/SRR10357002.markdup.txt | cut -d' ' -f1 | tr '
' '	' | sed 's/^/SRR10357002	/' | sed -e '$a\' > Sambamba/SRR10357002.dup.converted.tsv 2> Sambamba/logs/SRR10357002.convert_flagstat_output.log
        

[Wed Jul 27 17:39:38 2022]
rule MACS2:
    input: filtered_bam/SRR10356997.filtered.bam, filtered_bam/SRR10356999.filtered.bam
    output: MACS2/SRR10356997.filtered.BAM_peaks.xls
    log: MACS2/logs/MACS2.SRR10356997.filtered.out, MACS2/logs/MACS2.SRR10356997.filtered.err
    jobid: 6
    benchmark: MACS2/.benchmark/MACS2.SRR10356997.filtered.benchmark
    reason: Missing output files: MACS2/SRR10356997.filtered.BAM_peaks.xls
    wildcards: chip_sample=SRR10356997
    resources: tmpdir=/datastore/homes3/kchhatba/temp


            macs2 callpeak -t filtered_bam/SRR10356997.filtered.bam  -c filtered_bam/SRR10356999.filtered.bam -f BAM -g 2652783500             -g mm -m 1 30 -p 0.2 --call-summits --keep-dup all --keep-dup all --outdir MACS2             --name SRR10356997.filtered.BAM --mfold 0 50 --extsize 150              > MACS2/logs/MACS2.SRR10356997.filtered.out 2> MACS2/logs/MACS2.SRR10356997.filtered.err
            
Activating conda environment: ../../../../../../../../../../localdisk/home/kchhatba/mambaforge/envs/ab713b15b628540f558bb8c1820e193f

[Wed Jul 27 17:39:38 2022]
rule convert_flagstat_output:
    input: Sambamba/SRR10357004.markdup.txt
    output: Sambamba/SRR10357004.dup.converted.tsv
    log: Sambamba/logs/SRR10357004.convert_flagstat_output.log
    jobid: 23
    reason: Missing output files: Sambamba/SRR10357004.dup.converted.tsv
    wildcards: sample=SRR10357004
    resources: tmpdir=/datastore/homes3/kchhatba/temp


        sed -n '1p;4p;5p' Sambamba/SRR10357004.markdup.txt | cut -d' ' -f1 | tr '
' '	' | sed 's/^/SRR10357004	/' | sed -e '$a\' > Sambamba/SRR10357004.dup.converted.tsv 2> Sambamba/logs/SRR10357004.convert_flagstat_output.log
        
[Wed Jul 27 17:39:39 2022]
Finished job 16.
3 of 24 steps (12%) done
[Wed Jul 27 17:39:39 2022]
Finished job 18.
4 of 24 steps (17%) done
[Wed Jul 27 17:39:39 2022]
Finished job 21.
5 of 24 steps (21%) done
Select jobs to execute...

[Wed Jul 27 17:39:39 2022]
rule convert_flagstat_output:
    input: Sambamba/SRR10357001.markdup.txt
    output: Sambamba/SRR10357001.dup.converted.tsv
    log: Sambamba/logs/SRR10357001.convert_flagstat_output.log
    jobid: 20
    reason: Missing output files: Sambamba/SRR10357001.dup.converted.tsv
    wildcards: sample=SRR10357001
    resources: tmpdir=/datastore/homes3/kchhatba/temp


        sed -n '1p;4p;5p' Sambamba/SRR10357001.markdup.txt | cut -d' ' -f1 | tr '
' '	' | sed 's/^/SRR10357001	/' | sed -e '$a\' > Sambamba/SRR10357001.dup.converted.tsv 2> Sambamba/logs/SRR10357001.convert_flagstat_output.log
        

[Wed Jul 27 17:39:39 2022]
rule convert_flagstat_output:
    input: Sambamba/SRR10357003.markdup.txt
    output: Sambamba/SRR10357003.dup.converted.tsv
    log: Sambamba/logs/SRR10357003.convert_flagstat_output.log
    jobid: 22
    reason: Missing output files: Sambamba/SRR10357003.dup.converted.tsv
    wildcards: sample=SRR10357003
    resources: tmpdir=/datastore/homes3/kchhatba/temp


        sed -n '1p;4p;5p' Sambamba/SRR10357003.markdup.txt | cut -d' ' -f1 | tr '
' '	' | sed 's/^/SRR10357003	/' | sed -e '$a\' > Sambamba/SRR10357003.dup.converted.tsv 2> Sambamba/logs/SRR10357003.convert_flagstat_output.log
        

[Wed Jul 27 17:39:39 2022]
rule MACS2:
    input: filtered_bam/SRR10356998.filtered.bam, filtered_bam/SRR10357000.filtered.bam
    output: MACS2/SRR10356998.filtered.BAM_peaks.xls
    log: MACS2/logs/MACS2.SRR10356998.filtered.out, MACS2/logs/MACS2.SRR10356998.filtered.err
    jobid: 7
    benchmark: MACS2/.benchmark/MACS2.SRR10356998.filtered.benchmark
    reason: Missing output files: MACS2/SRR10356998.filtered.BAM_peaks.xls
    wildcards: chip_sample=SRR10356998
    resources: tmpdir=/datastore/homes3/kchhatba/temp


            macs2 callpeak -t filtered_bam/SRR10356998.filtered.bam  -c filtered_bam/SRR10357000.filtered.bam -f BAM -g 2652783500             -g mm -m 1 30 -p 0.2 --call-summits --keep-dup all --keep-dup all --outdir MACS2             --name SRR10356998.filtered.BAM --mfold 0 50 --extsize 150              > MACS2/logs/MACS2.SRR10356998.filtered.out 2> MACS2/logs/MACS2.SRR10356998.filtered.err
            
Activating conda environment: ../../../../../../../../../../localdisk/home/kchhatba/mambaforge/envs/ab713b15b628540f558bb8c1820e193f
[Wed Jul 27 17:39:39 2022]
Finished job 23.
6 of 24 steps (25%) done
[Wed Jul 27 17:39:39 2022]
Finished job 20.
7 of 24 steps (29%) done
[Wed Jul 27 17:39:39 2022]
Finished job 22.
8 of 24 steps (33%) done
Select jobs to execute...

[Wed Jul 27 17:39:39 2022]
rule convert_flagstat_output:
    input: Sambamba/SRR10357000.markdup.txt
    output: Sambamba/SRR10357000.dup.converted.tsv
    log: Sambamba/logs/SRR10357000.convert_flagstat_output.log
    jobid: 19
    reason: Missing output files: Sambamba/SRR10357000.dup.converted.tsv
    wildcards: sample=SRR10357000
    resources: tmpdir=/datastore/homes3/kchhatba/temp


        sed -n '1p;4p;5p' Sambamba/SRR10357000.markdup.txt | cut -d' ' -f1 | tr '
' '	' | sed 's/^/SRR10357000	/' | sed -e '$a\' > Sambamba/SRR10357000.dup.converted.tsv 2> Sambamba/logs/SRR10357000.convert_flagstat_output.log
        

[Wed Jul 27 17:39:39 2022]
rule convert_flagstat_output:
    input: Sambamba/SRR10356998.markdup.txt
    output: Sambamba/SRR10356998.dup.converted.tsv
    log: Sambamba/logs/SRR10356998.convert_flagstat_output.log
    jobid: 17
    reason: Missing output files: Sambamba/SRR10356998.dup.converted.tsv
    wildcards: sample=SRR10356998
    resources: tmpdir=/datastore/homes3/kchhatba/temp


        sed -n '1p;4p;5p' Sambamba/SRR10356998.markdup.txt | cut -d' ' -f1 | tr '
' '	' | sed 's/^/SRR10356998	/' | sed -e '$a\' > Sambamba/SRR10356998.dup.converted.tsv 2> Sambamba/logs/SRR10356998.convert_flagstat_output.log
        

[Wed Jul 27 17:39:39 2022]
rule MACS2:
    input: filtered_bam/SRR10357002.filtered.bam, filtered_bam/SRR10357004.filtered.bam
    output: MACS2/SRR10357002.filtered.BAM_peaks.xls
    log: MACS2/logs/MACS2.SRR10357002.filtered.out, MACS2/logs/MACS2.SRR10357002.filtered.err
    jobid: 9
    benchmark: MACS2/.benchmark/MACS2.SRR10357002.filtered.benchmark
    reason: Missing output files: MACS2/SRR10357002.filtered.BAM_peaks.xls
    wildcards: chip_sample=SRR10357002
    resources: tmpdir=/datastore/homes3/kchhatba/temp


            macs2 callpeak -t filtered_bam/SRR10357002.filtered.bam  -c filtered_bam/SRR10357004.filtered.bam -f BAM -g 2652783500             -g mm -m 1 30 -p 0.2 --call-summits --keep-dup all --keep-dup all --outdir MACS2             --name SRR10357002.filtered.BAM --mfold 0 50 --extsize 150              > MACS2/logs/MACS2.SRR10357002.filtered.out 2> MACS2/logs/MACS2.SRR10357002.filtered.err
            
Activating conda environment: ../../../../../../../../../../localdisk/home/kchhatba/mambaforge/envs/ab713b15b628540f558bb8c1820e193f
[Wed Jul 27 17:39:39 2022]
Finished job 19.
9 of 24 steps (38%) done
[Wed Jul 27 17:39:39 2022]
Finished job 17.
10 of 24 steps (42%) done
Select jobs to execute...

[Wed Jul 27 17:39:39 2022]
rule report_flagstat_all_data:
    input: Sambamba/SRR10356997.dup.converted.tsv, Sambamba/SRR10356998.dup.converted.tsv, Sambamba/SRR10356999.dup.converted.tsv, Sambamba/SRR10357000.dup.converted.tsv, Sambamba/SRR10357001.dup.converted.tsv, Sambamba/SRR10357002.dup.converted.tsv, Sambamba/SRR10357003.dup.converted.tsv, Sambamba/SRR10357004.dup.converted.tsv
    output: Sambamba/flagstat_report_all.tsv
    log: Sambamba/logs/report_flagstat_all_data.log
    jobid: 15
    reason: Missing output files: Sambamba/flagstat_report_all.tsv; Input files updated by another job: Sambamba/SRR10357001.dup.converted.tsv, Sambamba/SRR10356997.dup.converted.tsv, Sambamba/SRR10357002.dup.converted.tsv, Sambamba/SRR10357003.dup.converted.tsv, Sambamba/SRR10356999.dup.converted.tsv, Sambamba/SRR10356998.dup.converted.tsv, Sambamba/SRR10357000.dup.converted.tsv, Sambamba/SRR10357004.dup.converted.tsv
    resources: tmpdir=/datastore/homes3/kchhatba/temp


        echo -e 'sample	total	dup	mapped' > Sambamba/flagstat_report_all.tsv
        sort -k1,1V Sambamba/SRR10356997.dup.converted.tsv Sambamba/SRR10356998.dup.converted.tsv Sambamba/SRR10356999.dup.converted.tsv Sambamba/SRR10357000.dup.converted.tsv Sambamba/SRR10357001.dup.converted.tsv Sambamba/SRR10357002.dup.converted.tsv Sambamba/SRR10357003.dup.converted.tsv Sambamba/SRR10357004.dup.converted.tsv >> Sambamba/flagstat_report_all.tsv
        2> Sambamba/logs/report_flagstat_all_data.log
        

[Wed Jul 27 17:39:39 2022]
rule MACS2:
    input: filtered_bam/SRR10357001.filtered.bam, filtered_bam/SRR10357003.filtered.bam
    output: MACS2/SRR10357001.filtered.BAM_peaks.xls
    log: MACS2/logs/MACS2.SRR10357001.filtered.out, MACS2/logs/MACS2.SRR10357001.filtered.err
    jobid: 8
    benchmark: MACS2/.benchmark/MACS2.SRR10357001.filtered.benchmark
    reason: Missing output files: MACS2/SRR10357001.filtered.BAM_peaks.xls
    wildcards: chip_sample=SRR10357001
    resources: tmpdir=/datastore/homes3/kchhatba/temp


            macs2 callpeak -t filtered_bam/SRR10357001.filtered.bam  -c filtered_bam/SRR10357003.filtered.bam -f BAM -g 2652783500             -g mm -m 1 30 -p 0.2 --call-summits --keep-dup all --keep-dup all --outdir MACS2             --name SRR10357001.filtered.BAM --mfold 0 50 --extsize 150              > MACS2/logs/MACS2.SRR10357001.filtered.out 2> MACS2/logs/MACS2.SRR10357001.filtered.err
            
Activating conda environment: ../../../../../../../../../../localdisk/home/kchhatba/mambaforge/envs/ab713b15b628540f558bb8c1820e193f
Select jobs to execute...
[Wed Jul 27 17:39:39 2022]
Finished job 15.
11 of 24 steps (46%) done
Removing temporary output Sambamba/SRR10356997.dup.converted.tsv.
Removing temporary output Sambamba/SRR10356998.dup.converted.tsv.
Removing temporary output Sambamba/SRR10356999.dup.converted.tsv.
Removing temporary output Sambamba/SRR10357000.dup.converted.tsv.
Removing temporary output Sambamba/SRR10357001.dup.converted.tsv.
Removing temporary output Sambamba/SRR10357002.dup.converted.tsv.
Removing temporary output Sambamba/SRR10357003.dup.converted.tsv.
Removing temporary output Sambamba/SRR10357004.dup.converted.tsv.

[Wed Jul 27 17:39:39 2022]
rule qc_report_all:
    input: Sambamba/flagstat_report_all.tsv, deepTools_ChIP/plotFingerprint/plotFingerprint.metrics.txt
    output: QC_report/QC_report_all.tsv
    log: QC_report/logs/qc_report_all.log
    jobid: 14
    reason: Missing output files: QC_report/QC_report_all.tsv; Input files updated by another job: Sambamba/flagstat_report_all.tsv, deepTools_ChIP/plotFingerprint/plotFingerprint.metrics.txt
    resources: tmpdir=/datastore/homes3/kchhatba/temp


        awk 'NR == 1; NR > 1 {print $0 | "sort -k1,1V"}' deepTools_ChIP/plotFingerprint/plotFingerprint.metrics.txt | cut -f4,8,10,12 | paste Sambamba/flagstat_report_all.tsv - > QC_report/QC_report_all.tsv 2> QC_report/logs/qc_report_all.log
        
Select jobs to execute...
[Wed Jul 27 17:39:39 2022]
Finished job 14.
12 of 24 steps (50%) done
[Wed Jul 27 17:46:31 2022]
Finished job 7.
13 of 24 steps (54%) done

[Wed Jul 27 17:46:32 2022]
rule MACS2_peak_qc:
    input: filtered_bam/SRR10356998.filtered.bam, MACS2/SRR10356998.filtered.BAM_peaks.xls
    output: MACS2/SRR10356998.filtered.BAM_peaks.qc.txt
    jobid: 11
    benchmark: MACS2/.benchmark/MACS2_peak_qc.SRR10356998.filtered.benchmark
    reason: Missing output files: MACS2/SRR10356998.filtered.BAM_peaks.qc.txt; Input files updated by another job: MACS2/SRR10356998.filtered.BAM_peaks.xls
    wildcards: sample=SRR10356998
    resources: tmpdir=/datastore/homes3/kchhatba/temp


        # get the number of peaks
        peak_count=`wc -l < MACS2/SRR10356998.filtered.BAM_peaks.narrowPeak`

        # get the number of mapped reads
        mapped_reads=`samtools view -c -F 4 filtered_bam/SRR10356998.filtered.bam`

        # calculate the number of alignments overlapping the peaks
        # exclude reads flagged as unmapped (unmapped reads will be reported when using -L)
        reads_in_peaks=`samtools view -c -F 4 -L MACS2/SRR10356998.filtered.BAM_peaks.narrowPeak filtered_bam/SRR10356998.filtered.bam`

        # calculate Fraction of Reads In Peaks
        frip=`bc -l <<< "$reads_in_peaks/$mapped_reads"`

        # compute peak genome coverage
        peak_len=`awk '{total+=$3-$2}END{print total}' MACS2/SRR10356998.filtered.BAM_peaks.narrowPeak`
        genome_size=`awk '{total+=$3-$2}END{print total}' /datastore/homes3/kchhatba/temp/GRCm38_gencode_release19/genome_fasta/genome.fa.fai`
        genomecov=`bc -l <<< "$peak_len/$genome_size"`

        # write peak-based QC metrics to output file
        printf "peak_count	FRiP	peak_genome_coverage
%d	%5.3f	%6.4f
" $peak_count $frip $genomecov > MACS2/SRR10356998.filtered.BAM_peaks.qc.txt
        
Activating conda environment: ../../../../../../../../../../localdisk/home/kchhatba/mambaforge/envs/13f8b7bb80e180b51e4fd84d66270711
[Wed Jul 27 17:46:51 2022]
Finished job 9.
14 of 24 steps (58%) done
Select jobs to execute...

[Wed Jul 27 17:46:51 2022]
rule MACS2_peak_qc:
    input: filtered_bam/SRR10357002.filtered.bam, MACS2/SRR10357002.filtered.BAM_peaks.xls
    output: MACS2/SRR10357002.filtered.BAM_peaks.qc.txt
    jobid: 13
    benchmark: MACS2/.benchmark/MACS2_peak_qc.SRR10357002.filtered.benchmark
    reason: Missing output files: MACS2/SRR10357002.filtered.BAM_peaks.qc.txt; Input files updated by another job: MACS2/SRR10357002.filtered.BAM_peaks.xls
    wildcards: sample=SRR10357002
    resources: tmpdir=/datastore/homes3/kchhatba/temp


        # get the number of peaks
        peak_count=`wc -l < MACS2/SRR10357002.filtered.BAM_peaks.narrowPeak`

        # get the number of mapped reads
        mapped_reads=`samtools view -c -F 4 filtered_bam/SRR10357002.filtered.bam`

        # calculate the number of alignments overlapping the peaks
        # exclude reads flagged as unmapped (unmapped reads will be reported when using -L)
        reads_in_peaks=`samtools view -c -F 4 -L MACS2/SRR10357002.filtered.BAM_peaks.narrowPeak filtered_bam/SRR10357002.filtered.bam`

        # calculate Fraction of Reads In Peaks
        frip=`bc -l <<< "$reads_in_peaks/$mapped_reads"`

        # compute peak genome coverage
        peak_len=`awk '{total+=$3-$2}END{print total}' MACS2/SRR10357002.filtered.BAM_peaks.narrowPeak`
        genome_size=`awk '{total+=$3-$2}END{print total}' /datastore/homes3/kchhatba/temp/GRCm38_gencode_release19/genome_fasta/genome.fa.fai`
        genomecov=`bc -l <<< "$peak_len/$genome_size"`

        # write peak-based QC metrics to output file
        printf "peak_count	FRiP	peak_genome_coverage
%d	%5.3f	%6.4f
" $peak_count $frip $genomecov > MACS2/SRR10357002.filtered.BAM_peaks.qc.txt
        
Activating conda environment: ../../../../../../../../../../localdisk/home/kchhatba/mambaforge/envs/13f8b7bb80e180b51e4fd84d66270711
[Wed Jul 27 17:46:58 2022]
Finished job 8.
15 of 24 steps (62%) done
Select jobs to execute...

[Wed Jul 27 17:46:58 2022]
rule MACS2_peak_qc:
    input: filtered_bam/SRR10357001.filtered.bam, MACS2/SRR10357001.filtered.BAM_peaks.xls
    output: MACS2/SRR10357001.filtered.BAM_peaks.qc.txt
    jobid: 12
    benchmark: MACS2/.benchmark/MACS2_peak_qc.SRR10357001.filtered.benchmark
    reason: Missing output files: MACS2/SRR10357001.filtered.BAM_peaks.qc.txt; Input files updated by another job: MACS2/SRR10357001.filtered.BAM_peaks.xls
    wildcards: sample=SRR10357001
    resources: tmpdir=/datastore/homes3/kchhatba/temp


        # get the number of peaks
        peak_count=`wc -l < MACS2/SRR10357001.filtered.BAM_peaks.narrowPeak`

        # get the number of mapped reads
        mapped_reads=`samtools view -c -F 4 filtered_bam/SRR10357001.filtered.bam`

        # calculate the number of alignments overlapping the peaks
        # exclude reads flagged as unmapped (unmapped reads will be reported when using -L)
        reads_in_peaks=`samtools view -c -F 4 -L MACS2/SRR10357001.filtered.BAM_peaks.narrowPeak filtered_bam/SRR10357001.filtered.bam`

        # calculate Fraction of Reads In Peaks
        frip=`bc -l <<< "$reads_in_peaks/$mapped_reads"`

        # compute peak genome coverage
        peak_len=`awk '{total+=$3-$2}END{print total}' MACS2/SRR10357001.filtered.BAM_peaks.narrowPeak`
        genome_size=`awk '{total+=$3-$2}END{print total}' /datastore/homes3/kchhatba/temp/GRCm38_gencode_release19/genome_fasta/genome.fa.fai`
        genomecov=`bc -l <<< "$peak_len/$genome_size"`

        # write peak-based QC metrics to output file
        printf "peak_count	FRiP	peak_genome_coverage
%d	%5.3f	%6.4f
" $peak_count $frip $genomecov > MACS2/SRR10357001.filtered.BAM_peaks.qc.txt
        
Activating conda environment: ../../../../../../../../../../localdisk/home/kchhatba/mambaforge/envs/13f8b7bb80e180b51e4fd84d66270711
[Wed Jul 27 17:47:22 2022]
Finished job 12.
16 of 24 steps (67%) done
Select jobs to execute...
[Wed Jul 27 17:47:23 2022]
Finished job 11.
17 of 24 steps (71%) done
[Wed Jul 27 17:47:24 2022]
Finished job 6.
18 of 24 steps (75%) done

[Wed Jul 27 17:47:24 2022]
rule MACS2_peak_qc:
    input: filtered_bam/SRR10356997.filtered.bam, MACS2/SRR10356997.filtered.BAM_peaks.xls
    output: MACS2/SRR10356997.filtered.BAM_peaks.qc.txt
    jobid: 10
    benchmark: MACS2/.benchmark/MACS2_peak_qc.SRR10356997.filtered.benchmark
    reason: Missing output files: MACS2/SRR10356997.filtered.BAM_peaks.qc.txt; Input files updated by another job: MACS2/SRR10356997.filtered.BAM_peaks.xls
    wildcards: sample=SRR10356997
    resources: tmpdir=/datastore/homes3/kchhatba/temp


        # get the number of peaks
        peak_count=`wc -l < MACS2/SRR10356997.filtered.BAM_peaks.narrowPeak`

        # get the number of mapped reads
        mapped_reads=`samtools view -c -F 4 filtered_bam/SRR10356997.filtered.bam`

        # calculate the number of alignments overlapping the peaks
        # exclude reads flagged as unmapped (unmapped reads will be reported when using -L)
        reads_in_peaks=`samtools view -c -F 4 -L MACS2/SRR10356997.filtered.BAM_peaks.narrowPeak filtered_bam/SRR10356997.filtered.bam`

        # calculate Fraction of Reads In Peaks
        frip=`bc -l <<< "$reads_in_peaks/$mapped_reads"`

        # compute peak genome coverage
        peak_len=`awk '{total+=$3-$2}END{print total}' MACS2/SRR10356997.filtered.BAM_peaks.narrowPeak`
        genome_size=`awk '{total+=$3-$2}END{print total}' /datastore/homes3/kchhatba/temp/GRCm38_gencode_release19/genome_fasta/genome.fa.fai`
        genomecov=`bc -l <<< "$peak_len/$genome_size"`

        # write peak-based QC metrics to output file
        printf "peak_count	FRiP	peak_genome_coverage
%d	%5.3f	%6.4f
" $peak_count $frip $genomecov > MACS2/SRR10356997.filtered.BAM_peaks.qc.txt
        
Activating conda environment: ../../../../../../../../../../localdisk/home/kchhatba/mambaforge/envs/13f8b7bb80e180b51e4fd84d66270711
[Wed Jul 27 17:47:40 2022]
Finished job 13.
19 of 24 steps (79%) done
Select jobs to execute...
[Wed Jul 27 17:47:56 2022]
Finished job 10.
20 of 24 steps (83%) done

[Wed Jul 27 17:47:56 2022]
rule bamCompare_log2:
    input: filtered_bam/SRR10357002.filtered.bam, filtered_bam/SRR10357002.filtered.bam.bai, filtered_bam/SRR10357004.filtered.bam, filtered_bam/SRR10357004.filtered.bam.bai
    output: deepTools_ChIP/bamCompare/SRR10357002.filtered.log2ratio.over_SRR10357004.bw
    log: deepTools_ChIP/logs/bamCompare.log2ratio.SRR10357002.SRR10357004.filtered.out, deepTools_ChIP/logs/bamCompare.log2ratio.SRR10357002.SRR10357004.filtered.err
    jobid: 5
    benchmark: deepTools_ChIP/.benchmark/bamCompare.log2ratio.SRR10357002.SRR10357004.filtered.benchmark
    reason: Missing output files: deepTools_ChIP/bamCompare/SRR10357002.filtered.log2ratio.over_SRR10357004.bw
    wildcards: chip_sample=SRR10357002, control_name=SRR10357004
    threads: 5
    resources: tmpdir=/datastore/homes3/kchhatba/temp


    bamCompare -b1 filtered_bam/SRR10357002.filtered.bam                -b2 filtered_bam/SRR10357004.filtered.bam                -o deepTools_ChIP/bamCompare/SRR10357002.filtered.log2ratio.over_SRR10357004.bw                --operation log2                 --scaleFactorsMethod readCount                 --ignoreForNormalization chrX chrY chrM GL456210.1 GL456211.1 GL456212.1 GL456213.1 GL456216.1 GL456219.1 GL456221.1 GL456233.1 GL456239.1 GL456350.1 GL456354.1 GL456359.1 GL456360.1 GL456366.1 GL456367.1 GL456368.1 GL456370.1 GL456372.1 GL456378.1 GL456379.1 GL456381.1 GL456382.1 GL456383.1 GL456385.1 GL456387.1 GL456389.1 GL456390.1 GL456392.1 GL456393.1 GL456394.1 GL456396.1 JH584292.1 JH584293.1 JH584294.1 JH584295.1 JH584296.1 JH584297.1 JH584298.1 JH584299.1 JH584300.1 JH584301.1 JH584302.1 JH584303.1 JH584304.1                --binSize 1000                -p 5                --extendReads 150                --blackListFileName /datastore/homes3/kchhatba/temp/GRCm38_gencode_release19/mm10-blacklist.v2.bed > deepTools_ChIP/logs/bamCompare.log2ratio.SRR10357002.SRR10357004.filtered.out 2> deepTools_ChIP/logs/bamCompare.log2ratio.SRR10357002.SRR10357004.filtered.err
    
Activating conda environment: ../../../../../../../../../../localdisk/home/kchhatba/mambaforge/envs/13f8b7bb80e180b51e4fd84d66270711
[Wed Jul 27 17:51:32 2022]
Finished job 5.
21 of 24 steps (88%) done
Select jobs to execute...

[Wed Jul 27 17:51:32 2022]
rule bamCompare_log2:
    input: filtered_bam/SRR10356998.filtered.bam, filtered_bam/SRR10356998.filtered.bam.bai, filtered_bam/SRR10357000.filtered.bam, filtered_bam/SRR10357000.filtered.bam.bai
    output: deepTools_ChIP/bamCompare/SRR10356998.filtered.log2ratio.over_SRR10357000.bw
    log: deepTools_ChIP/logs/bamCompare.log2ratio.SRR10356998.SRR10357000.filtered.out, deepTools_ChIP/logs/bamCompare.log2ratio.SRR10356998.SRR10357000.filtered.err
    jobid: 3
    benchmark: deepTools_ChIP/.benchmark/bamCompare.log2ratio.SRR10356998.SRR10357000.filtered.benchmark
    reason: Missing output files: deepTools_ChIP/bamCompare/SRR10356998.filtered.log2ratio.over_SRR10357000.bw
    wildcards: chip_sample=SRR10356998, control_name=SRR10357000
    threads: 5
    resources: tmpdir=/datastore/homes3/kchhatba/temp


    bamCompare -b1 filtered_bam/SRR10356998.filtered.bam                -b2 filtered_bam/SRR10357000.filtered.bam                -o deepTools_ChIP/bamCompare/SRR10356998.filtered.log2ratio.over_SRR10357000.bw                --operation log2                 --scaleFactorsMethod readCount                 --ignoreForNormalization chrX chrY chrM GL456210.1 GL456211.1 GL456212.1 GL456213.1 GL456216.1 GL456219.1 GL456221.1 GL456233.1 GL456239.1 GL456350.1 GL456354.1 GL456359.1 GL456360.1 GL456366.1 GL456367.1 GL456368.1 GL456370.1 GL456372.1 GL456378.1 GL456379.1 GL456381.1 GL456382.1 GL456383.1 GL456385.1 GL456387.1 GL456389.1 GL456390.1 GL456392.1 GL456393.1 GL456394.1 GL456396.1 JH584292.1 JH584293.1 JH584294.1 JH584295.1 JH584296.1 JH584297.1 JH584298.1 JH584299.1 JH584300.1 JH584301.1 JH584302.1 JH584303.1 JH584304.1                --binSize 1000                -p 5                --extendReads 150                --blackListFileName /datastore/homes3/kchhatba/temp/GRCm38_gencode_release19/mm10-blacklist.v2.bed > deepTools_ChIP/logs/bamCompare.log2ratio.SRR10356998.SRR10357000.filtered.out 2> deepTools_ChIP/logs/bamCompare.log2ratio.SRR10356998.SRR10357000.filtered.err
    
Activating conda environment: ../../../../../../../../../../localdisk/home/kchhatba/mambaforge/envs/13f8b7bb80e180b51e4fd84d66270711
[Wed Jul 27 17:54:59 2022]
Finished job 3.
22 of 24 steps (92%) done
Select jobs to execute...

[Wed Jul 27 17:54:59 2022]
rule bamCompare_log2:
    input: filtered_bam/SRR10357001.filtered.bam, filtered_bam/SRR10357001.filtered.bam.bai, filtered_bam/SRR10357003.filtered.bam, filtered_bam/SRR10357003.filtered.bam.bai
    output: deepTools_ChIP/bamCompare/SRR10357001.filtered.log2ratio.over_SRR10357003.bw
    log: deepTools_ChIP/logs/bamCompare.log2ratio.SRR10357001.SRR10357003.filtered.out, deepTools_ChIP/logs/bamCompare.log2ratio.SRR10357001.SRR10357003.filtered.err
    jobid: 4
    benchmark: deepTools_ChIP/.benchmark/bamCompare.log2ratio.SRR10357001.SRR10357003.filtered.benchmark
    reason: Missing output files: deepTools_ChIP/bamCompare/SRR10357001.filtered.log2ratio.over_SRR10357003.bw
    wildcards: chip_sample=SRR10357001, control_name=SRR10357003
    threads: 5
    resources: tmpdir=/datastore/homes3/kchhatba/temp


    bamCompare -b1 filtered_bam/SRR10357001.filtered.bam                -b2 filtered_bam/SRR10357003.filtered.bam                -o deepTools_ChIP/bamCompare/SRR10357001.filtered.log2ratio.over_SRR10357003.bw                --operation log2                 --scaleFactorsMethod readCount                 --ignoreForNormalization chrX chrY chrM GL456210.1 GL456211.1 GL456212.1 GL456213.1 GL456216.1 GL456219.1 GL456221.1 GL456233.1 GL456239.1 GL456350.1 GL456354.1 GL456359.1 GL456360.1 GL456366.1 GL456367.1 GL456368.1 GL456370.1 GL456372.1 GL456378.1 GL456379.1 GL456381.1 GL456382.1 GL456383.1 GL456385.1 GL456387.1 GL456389.1 GL456390.1 GL456392.1 GL456393.1 GL456394.1 GL456396.1 JH584292.1 JH584293.1 JH584294.1 JH584295.1 JH584296.1 JH584297.1 JH584298.1 JH584299.1 JH584300.1 JH584301.1 JH584302.1 JH584303.1 JH584304.1                --binSize 1000                -p 5                --extendReads 150                --blackListFileName /datastore/homes3/kchhatba/temp/GRCm38_gencode_release19/mm10-blacklist.v2.bed > deepTools_ChIP/logs/bamCompare.log2ratio.SRR10357001.SRR10357003.filtered.out 2> deepTools_ChIP/logs/bamCompare.log2ratio.SRR10357001.SRR10357003.filtered.err
    
Activating conda environment: ../../../../../../../../../../localdisk/home/kchhatba/mambaforge/envs/13f8b7bb80e180b51e4fd84d66270711
[Wed Jul 27 17:58:26 2022]
Finished job 4.
23 of 24 steps (96%) done
Select jobs to execute...

[Wed Jul 27 17:58:26 2022]
localrule all:
    input: deepTools_ChIP/plotFingerprint/plotFingerprint.metrics.txt, deepTools_ChIP/bamCompare/SRR10356997.filtered.log2ratio.over_SRR10356999.bw, deepTools_ChIP/bamCompare/SRR10356998.filtered.log2ratio.over_SRR10357000.bw, deepTools_ChIP/bamCompare/SRR10357001.filtered.log2ratio.over_SRR10357003.bw, deepTools_ChIP/bamCompare/SRR10357002.filtered.log2ratio.over_SRR10357004.bw, MACS2/SRR10356997.filtered.BAM_peaks.xls, MACS2/SRR10356998.filtered.BAM_peaks.xls, MACS2/SRR10357001.filtered.BAM_peaks.xls, MACS2/SRR10357002.filtered.BAM_peaks.xls, MACS2/SRR10356997.filtered.BAM_peaks.qc.txt, MACS2/SRR10356998.filtered.BAM_peaks.qc.txt, MACS2/SRR10357001.filtered.BAM_peaks.qc.txt, MACS2/SRR10357002.filtered.BAM_peaks.qc.txt, QC_report/QC_report_all.tsv
    jobid: 0
    reason: Input files updated by another job: MACS2/SRR10357002.filtered.BAM_peaks.xls, MACS2/SRR10357001.filtered.BAM_peaks.qc.txt, MACS2/SRR10356998.filtered.BAM_peaks.xls, MACS2/SRR10356998.filtered.BAM_peaks.qc.txt, deepTools_ChIP/bamCompare/SRR10356998.filtered.log2ratio.over_SRR10357000.bw, MACS2/SRR10357002.filtered.BAM_peaks.qc.txt, MACS2/SRR10356997.filtered.BAM_peaks.qc.txt, MACS2/SRR10357001.filtered.BAM_peaks.xls, QC_report/QC_report_all.tsv, MACS2/SRR10356997.filtered.BAM_peaks.xls, deepTools_ChIP/bamCompare/SRR10356997.filtered.log2ratio.over_SRR10356999.bw, deepTools_ChIP/bamCompare/SRR10357001.filtered.log2ratio.over_SRR10357003.bw, deepTools_ChIP/bamCompare/SRR10357002.filtered.log2ratio.over_SRR10357004.bw, deepTools_ChIP/plotFingerprint/plotFingerprint.metrics.txt
    resources: tmpdir=/datastore/homes3/kchhatba/temp

[Wed Jul 27 17:58:26 2022]
Finished job 0.
24 of 24 steps (100%) done
Complete log: .snakemake/log/2022-07-27T135007.255397.snakemake.log
